<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Profile - WorkLink</title>
    <link href="assets/css/theme.css" rel="stylesheet" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light fixed-top py-3 backdrop">
      <div class="container">
        <a
          class="navbar-brand d-flex align-items-center fw-bolder fs-2 fst-italic"
          href="index.html"
          ><div class="text-info">          <div class="text-info">Work</div>
</div>
          <div class="text-warning">Link</div></a
        >
      </div>
    </nav>
    <main class="container" style="padding-top: 120px">
      <div id="profileContainer"></div>
      <hr />
      <div id="inboxContainer"></div>
    </main>

    <script src="vendors/@popperjs/popper.min.js"></script>
    <script src="vendors/bootstrap/bootstrap.min.js"></script>
    <script src="assets/js/theme.js"></script>
    <script src="assets/js/firebase-config.js"></script>
    <script type="module" src="assets/js/firebase-init.js"></script>
    <script src="assets/js/tasks.js"></script>
    <script>
      (function () {
        function qs(k) {
          return new URLSearchParams(location.search).get(k);
        }
        const username = qs("u");
        const user = window.LH.findUserByUsername(username);
        const profile = document.getElementById("profileContainer");
        if (!user) {
          profile.innerHTML = "<p>User not found.</p>";
          return;
        }
        profile.innerHTML =
          '<div id="profileDetails">'
            + "<h2>" + user.name + " (" + user.username + ")</h2>"
            + '<p id="profileBio">' + (user.bio || "") + '</p>'
            + (user.avatar ? '<img id="profileAvatar" src="' + user.avatar + '" style="max-width:200px">' : '')
          + '</div>';

        // If signed-in user is viewing their own profile, show Edit button
        const curUser = window.LH.currentUser ? window.LH.currentUser() : null;
        if (curUser && curUser.username === user.username) {
          const editBtn = document.createElement('button');
          editBtn.className = 'btn btn-outline-secondary mb-3';
          editBtn.textContent = 'Edit Profile';
          editBtn.id = 'editProfileBtn';
          profile.insertBefore(editBtn, profile.firstChild);
        }

        // Build Edit Profile modal 
        function ensureEditModal() {
          if (document.getElementById('editProfileModal')) return document.getElementById('editProfileModal');
          const div = document.createElement('div');
          div.innerHTML = `
            <div class="modal fade" id="editProfileModal" tabindex="-1" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header"><h5 class="modal-title">Edit Profile</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
                  <div class="modal-body">
                    <form id="editProfileForm">
                      <div class="mb-2"><label class="form-label">Display name</label><input class="form-control" name="displayName" id="fldDisplayName"></div>
                      <div class="mb-2"><label class="form-label">Email</label><input class="form-control" type="email" name="email" id="fldEmail"></div>
                      <div class="mb-2"><label class="form-label">Phone</label><input class="form-control" name="phone" id="fldPhone"></div>
                      <div class="mb-2"><label class="form-label">NIN</label><input class="form-control" name="nin" id="fldNIN"></div>
                      <div class="mb-2"><label class="form-label">State</label><input class="form-control" name="state" id="fldState"></div>
                      <div class="mb-2"><label class="form-label">Home address</label><input class="form-control" name="address" id="fldAddress"></div>
                      <div class="mb-2"><label class="form-label">Bio</label><textarea class="form-control" name="bio" id="fldBio" rows="3"></textarea></div>
                      <div class="mb-2"><label class="form-label">Avatar URL</label><input class="form-control" name="avatar" id="fldAvatar"></div>
                      <div class="text-end"><button class="btn btn-primary" type="submit">Save</button></div>
                    </form>
                  </div>
                </div>
              </div>
            </div>`;
          document.body.appendChild(div);
          return document.getElementById('editProfileModal');
        }

        // Open modal when Edit button clicked
        const editBtnEl = document.getElementById('editProfileBtn');
        if (editBtnEl) {
          editBtnEl.addEventListener('click', function () {
            const modalEl = ensureEditModal();
            // populate fields
            document.getElementById('fldDisplayName').value = user.name || '';
            document.getElementById('fldEmail').value = user.email || '';
            document.getElementById('fldPhone').value = user.phone || '';
            document.getElementById('fldNIN').value = user.nin || '';
            document.getElementById('fldState').value = user.state || '';
            document.getElementById('fldAddress').value = user.address || '';
            document.getElementById('fldBio').value = user.bio || '';
            document.getElementById('fldAvatar').value = user.avatar || '';
            const m = new bootstrap.Modal(modalEl);
            m.show();
            // bind save
            const form = document.getElementById('editProfileForm');
            form.onsubmit = function (e) {
              e.preventDefault();
              try {
                const updates = {
                  username: user.username,
                  name: document.getElementById('fldDisplayName').value || user.name,
                  email: document.getElementById('fldEmail').value || user.email,
                  phone: document.getElementById('fldPhone').value || user.phone,
                  nin: document.getElementById('fldNIN').value || user.nin,
                  state: document.getElementById('fldState').value || user.state,
                  address: document.getElementById('fldAddress').value || user.address,
                  bio: document.getElementById('fldBio').value || user.bio,
                  avatar: document.getElementById('fldAvatar').value || user.avatar
                };
                const saved = window.LH.updateUser(updates);
                if (!saved) return window.LH.showInfo('Error', 'User not found');
                m.hide();
                window.LH.showInfo('Saved', 'Profile updated').then(function () { location.reload(); });
              } catch (err) { console.error(err); window.LH.showInfo('Error','Unable to save profile'); }
            };
          });
        }

        // messages to/from this user
        const inbox = document.getElementById("inboxContainer");
        const msgs = window.LH.allMessages().filter(
          (m) => m.to === user.username || m.from === user.username
        );
        inbox.innerHTML =
          "<h4>Messages (" +
          msgs.length +
          ")</h4>" +
          (msgs
            .map(
              (m) =>
                '<div class="card p-2 mb-2"><strong>' +
                m.from +
                "</strong> -> <strong>" +
                m.to +
                "</strong><div>" +
                m.content +
                '</div><small class="text-muted">' +
                (window.LH.formatDate
                  ? window.LH.formatDate(m.createdAt)
                  : m.createdAt) +
                "</small></div>"
            )
            .join("") || "<p>No messages.</p>");

        // If signed in, provide a send form
        const cur = window.LH.currentUser ? window.LH.currentUser() : null;
        if (cur) {
          inbox.innerHTML +=
            '<hr><h5>Send message</h5><form id="pmForm"><div class="mb-2"><textarea class="form-control" id="pmText" rows="3" required></textarea></div><button class="btn btn-primary">Send</button></form>';
          document
            .getElementById("pmForm")
            .addEventListener("submit", async function (e) {
              e.preventDefault();
              const content = document.getElementById("pmText").value;
              await window.LH.sendMessage(cur.username, user.username, content);
              await window.LH.showInfo("Message sent", "Your message was sent");
              document.getElementById("pmText").value = "";
              location.reload();
            });
        } else {
          inbox.innerHTML += "<p>Please sign in to message this user.</p>";
        }
      })();
    </script>
      <section class="mt-7 py-0 bg-primary-gradient">
        <div class="bg-holder" style="background-image:url(assets/img/illustrations/footer-bg.png);background-position:center;background-size:cover;">
        </div>
        <!--/.bg-holder-->

        <div class="container">
          <div class="row flex-center py-8">
            <div class="col-lg-6 mb-4 text-center">
              <h1 class="text-white">Subscribe for latest updates</h1>
            </div>
            <div class="col-lg-6 d-flex justify-content-lg-end justify-content-center">
              <form class="row row-cols-lg-auto g-0 align-items-center">
                <div class="col-9 col-lg-8">
                  <label class="visually-hidden" for="colFormLabel">Username</label>
                  <div class="input-group">
                    <input class="rounded-end-0 form-control" id="colFormLabel" type="email" placeholder="email address" />
                  </div>
                </div>
                <div class="col-3 col-lg-4">
                  <button class="btn btn-primary rounded-start-0" type="submit">Subscribe</button>
                </div>
              </form>
            </div>
          </div>
<div class="flex text-center justify-center"> <a href="about.html">About Us</a> |  <a href="privacy.html">Privacy Policy</a> | <a href="terms.html">Terms of Use</a> | <a href="contact.html">Contact Us</a> | <a href="faq.html">FAQ</a></div>
          <div class="row flex-center">
            <div class="col-auto my-4">
              <ul class="list-unstyled list-inline">
                <li class="list-inline-item me-3"><a href="#!">
                    <svg class="bi bi-twitter" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#1F3A63" viewBox="0 0 16 16">
                      <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"></path>
                    </svg></a></li>
                <li class="list-inline-item me-3"><a class="text-decoration-none" href="#!">
                    <svg class="bi bi-facebook" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#1F3A63" viewBox="0 0 16 16">
                      <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"></path>
                    </svg></a></li>
                <li class="list-inline-item me-3"><a href="#!">
                    <svg class="bi bi-instagram" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#1F3A63" viewBox="0 0 16 16">
                      <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334z"> </path>
                    </svg></a></li>
              </ul>
            </div>
          </div>
          <div class="row justify-content-center">
            <div class="col-auto mb-2">
              <p class="mb-0 fs--1 text-white my-2 text-center">WorkLink 2025 &copy; made with &nbsp;
                <svg class="bi bi-suit-heart-fill" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#1F3A63" viewBox="0 0 16 16">
                  <path d="M4 1c2.21 0 4 1.755 4 3.92C8 2.755 9.79 1 12 1s4 1.755 4 3.92c0 3.263-3.234 4.414-7.608 9.608a.513.513 0 0 1-.784 0C3.234 9.334 0 8.183 0 4.92 0 2.755 1.79 1 4 1z"></path>
                </svg>&nbsp;by&nbsp; Team InfinitySquad for Africans
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>
    <!-- ===============================================-->
    <!--    End of Main Content-->
    <!-- ===============================================-->




    <!-- ===============================================-->
    <!--    JavaScripts-->
    <!-- ===============================================-->
    <script src="vendors/@popperjs/popper.min.js"></script>
    <script src="vendors/bootstrap/bootstrap.min.js"></script>
    <script src="vendors/is/is.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=window.scroll"></script>
    <script src="assets/js/theme.js"></script>
    <script src="assets/js/tasks.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400&amp;display=swap" rel="stylesheet">
  </body>

</html>